## Step 1: Improvements

- **상수 추출**: 중복된 에러 메시지 문자열을 상수 객체로 추출
- **DRY 원칙 적용**: 중복된 에러 검증 로직을 헬퍼 함수로 통합
- **함수 분리**: 날짜 파싱 및 검증 로직을 명확히 분리
- **타입 안정성 강화**: 상수 객체에 `as const` 적용
- **가독성 개선**: 헬퍼 함수 이름을 더 명확하게 변경
- **JSDoc 추가**: 모든 public/private 함수에 문서화 주석 추가

## Step 2: Complete Refactored Code

```typescript
// filepath: src/utils/validateDateRange.ts

/**
 * Validation result interface
 */
export interface ValidationResult {
  isValid: boolean;
  error?: string;
  warning?: string;
}

/**
 * Error message constants
 */
const ERROR_MESSAGES = {
  BOTH_REQUIRED: '시작일과 종료일은 필수입니다',
  START_REQUIRED: '시작일은 필수입니다',
  END_REQUIRED: '종료일은 필수입니다',
  INVALID_START_FORMAT: '유효하지 않은 시작일 형식입니다',
  INVALID_END_FORMAT: '유효하지 않은 종료일 형식입니다',
  START_AFTER_END: '시작일은 종료일보다 이전이어야 합니다',
} as const;

/**
 * Warning thresholds
 */
const WARNING_THRESHOLD = {
  MAX_YEARS: 100,
  MILLISECONDS_PER_YEAR: 365.25 * 24 * 60 * 60 * 1000,
} as const;

/**
 * Validates a date range between start and end dates
 * @param startDate - Start date (Date object or ISO 8601 string)
 * @param endDate - End date (Date object or ISO 8601 string)
 * @returns Validation result with error or warning if applicable
 */
export function validateDateRange(
  startDate: Date | string | null | undefined,
  endDate: Date | string | null | undefined
): ValidationResult {
  // Check for null/undefined inputs
  const requiredCheckResult = checkRequiredDates(startDate, endDate);
  if (requiredCheckResult) {
    return requiredCheckResult;
  }

  // Parse and validate dates
  const parsedStartDate = parseDate(startDate!);
  const parsedEndDate = parseDate(endDate!);

  const formatCheckResult = checkDateFormats(parsedStartDate, parsedEndDate);
  if (formatCheckResult) {
    return formatCheckResult;
  }

  // Compare dates
  if (parsedStartDate!.getTime() > parsedEndDate!.getTime()) {
    return createError(ERROR_MESSAGES.START_AFTER_END);
  }

  // Check for 100-year warning
  const yearsDifference = calculateYearsDifference(parsedStartDate!, parsedEndDate!);
  if (yearsDifference > WARNING_THRESHOLD.MAX_YEARS) {
    return createWarning(`날짜 범위가 ${WARNING_THRESHOLD.MAX_YEARS}년을 초과합니다`);
  }

  return { isValid: true };
}

/**
 * Checks if required dates are provided
 * @returns ValidationResult if validation fails, null if all checks pass
 */
function checkRequiredDates(
  startDate: Date | string | null | undefined,
  endDate: Date | string | null | undefined
): ValidationResult | null {
  if (!startDate && !endDate) {
    return createError(ERROR_MESSAGES.BOTH_REQUIRED);
  }

  if (!startDate) {
    return createError(ERROR_MESSAGES.START_REQUIRED);
  }

  if (!endDate) {
    return createError(ERROR_MESSAGES.END_REQUIRED);
  }

  return null;
}

/**
 * Checks if parsed dates are valid
 * @returns ValidationResult if validation fails, null if all checks pass
 */
function checkDateFormats(
  parsedStartDate: Date | null,
  parsedEndDate: Date | null
): ValidationResult | null {
  if (!parsedStartDate || !isValidDate(parsedStartDate)) {
    return createError(ERROR_MESSAGES.INVALID_START_FORMAT);
  }

  if (!parsedEndDate || !isValidDate(parsedEndDate)) {
    return createError(ERROR_MESSAGES.INVALID_END_FORMAT);
  }

  return null;
}

/**
 * Creates an error validation result
 * @param message - Error message
 * @returns ValidationResult with error
 */
function createError(message: string): ValidationResult {
  return {
    isValid: false,
    error: message,
  };
}

/**
 * Creates a warning validation result
 * @param message - Warning message
 * @returns ValidationResult with warning
 */
function createWarning(message: string): ValidationResult {
  return {
    isValid: true,
    warning: message,
  };
}

/**
 * Parses a date from Date object or string
 * @param date - Date object or ISO 8601 string
 * @returns Parsed Date object or null if invalid
 */
function parseDate(date: Date | string): Date | null {
  if (date instanceof Date) {
    return date;
  }

  if (typeof date === 'string') {
    return new Date(date);
  }

  return null;
}

/**
 * Checks if a Date object is valid
 * @param date - Date object to validate
 * @returns true if valid, false otherwise
 */
function isValidDate(date: Date): boolean {
  return date instanceof Date && !isNaN(date.getTime());
}

/**
 * Calculates the difference in years between two dates
 * @param startDate - Start date
 * @param endDate - End date
 * @returns Number of years between the dates
 */
function calculateYearsDifference(startDate: Date, endDate: Date): number {
  const timeDifference = endDate.getTime() - startDate.getTime();
  return timeDifference / WARNING_THRESHOLD.MILLISECONDS_PER_YEAR;
}
```
