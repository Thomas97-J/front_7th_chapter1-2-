이제 명세를 체계적으로 검증하겠습니다.

## 검증 결과

### 명확성
- **평가**: 개선 필요
- **의견**:
  1. "ISO 8601 문자열"이 정확히 어떤 형식을 지원하는지 불명확 (날짜만? 시간 포함? 타임존 포함?)
  2. "경고 메시지"가 정확히 어떻게 반환되는지 명세에 없음 (현재 테스트 코드에는 `warning` 필드가 있으나 명세에는 누락)
  3. "100년 이상 차이"의 기준이 모호함 (정확히 100년인 경우 포함/제외?)
  4. 에러 메시지의 정확한 문구가 명시되지 않음 (테스트 코드와 비교 시 불일치 가능성)

### 완전성
- **평가**: 개선 필요
- **의견**:
  1. **누락된 시나리오**:
     - 타임존이 포함된 날짜 처리 방법
     - 윤년 날짜 (2월 29일) 처리
     - 빈 문자열 입력
     - 숫자나 일반 객체 입력 (타입이 아닌 런타임)
     - Date 객체와 문자열 혼용 입력
     - 매우 오래된 날짜 (0001년) 또는 먼 미래 날짜 (9999년)
  2. **100년 기준의 경계값**: 정확히 100년인 경우의 동작이 명세에 없음
  3. **시간 단위 정밀도**: 날짜만 비교하는지, 시간까지 비교하는지 불명확

### 테스트 가능성
- **평가**: 통과
- **의견**:
  1. 각 요구사항에 대해 명확한 입출력이 정의됨
  2. 성공/실패 케이스가 구분 가능함
  3. 다만, 에러 메시지와 경고 메시지의 정확한 문구가 명세에 있으면 더 좋음

### 일관성
- **평가**: 개선 필요
- **의견**:
  1. **출력 형식 불일치**: 명세에는 경고 메시지를 반환하는 방법이 없으나, 엣지 케이스에서 경고를 언급함
  2. **100년 기준 충돌**: "100년 이상"이라고 했는데, 정확히 100년인 경우의 동작이 명시되지 않음
  3. **null과 undefined 처리**: 둘 다 에러를 반환하지만, 각각 다른 메시지를 반환하는지 명확하지 않음

---

## 개선된 명세

# 예제 기능 명세: 날짜 범위 검증 함수 (v2.0)

## 기능 설명
두 날짜 사이의 기간이 유효한지 검증하는 순수 함수를 구현합니다.

## 함수 시그니처
```typescript
function validateDateRange(
  startDate: Date | string | null | undefined,
  endDate: Date | string | null | undefined
): ValidationResult

interface ValidationResult {
  isValid: boolean;
  error?: string;
  warning?: string;
}
```

## 요구사항

### 1. 기본 동작
- **성공 조건**: 시작일 <= 종료일
  - 시작일이 종료일보다 이전: 유효
  - 시작일과 종료일이 동일: 유효
- **실패 조건**: 시작일 > 종료일
  - 반환: `{ isValid: false, error: '시작일은 종료일보다 이전이어야 합니다' }`

### 2. 입력 형식

#### 2.1 지원하는 입력 타입
1. **Date 객체**: JavaScript Date 인스턴스
2. **ISO 8601 문자열**: 다음 형식 모두 지원
   - 날짜만: `YYYY-MM-DD` (예: `2024-01-01`)
   - 날짜와 시간: `YYYY-MM-DDTHH:mm:ss` (예: `2024-01-01T12:30:00`)
   - 타임존 포함: `YYYY-MM-DDTHH:mm:ss.sssZ` 또는 `YYYY-MM-DDTHH:mm:ss+HH:mm` 
     (예: `2024-01-01T12:30:00.000Z`, `2024-06-15T23:00:00+09:00`)

#### 2.2 혼합 입력
- 시작일과 종료일은 서로 다른 타입 가능 (예: 시작일은 Date 객체, 종료일은 문자열)

#### 2.3 날짜 비교 정밀도
- 밀리초 단위까지 비교
- 타임존이 다른 경우 UTC로 정규화하여 비교

### 3. 출력 형식

#### 3.1 성공 케이스
```typescript
{ isValid: true }  // 경고가 없는 경우
{ isValid: true, warning: '날짜 범위가 100년을 초과합니다' }  // 경고가 있는 경우
```

#### 3.2 실패 케이스
```typescript
{ isValid: false, error: string }
```

### 4. 에러 처리

#### 4.1 null/undefined 입력
| 조건 | 에러 메시지 |
|-----|-----------|
| startDate가 null | `'시작일은 필수입니다'` |
| startDate가 undefined | `'시작일은 필수입니다'` |
| endDate가 null | `'종료일은 필수입니다'` |
| endDate가 undefined | `'종료일은 필수입니다'` |
| 둘 다 null 또는 undefined | `'시작일과 종료일은 필수입니다'` |

#### 4.2 잘못된 날짜 형식
다음의 경우 `{ isValid: false, error: '유효하지 않은 날짜 형식입니다' }` 반환:
- 빈 문자열 (`''`)
- 잘못된 날짜 형식 문자열 (`'invalid-date'`)
- 존재하지 않는 날짜 (`'2023-02-29'`, `'2024-13-45'`)
- Date 객체가 아닌 일반 객체 (`{ date: '2024-01-01' }`)
- 숫자 타입 입력 (`1234567890`)

#### 4.3 시작일 > 종료일
```typescript
{ isValid: false, error: '시작일은 종료일보다 이전이어야 합니다' }
```

### 5. 엣지 케이스와 경계값

#### 5.1 동일 날짜
- **조건**: 시작일 === 종료일 (밀리초 단위까지 동일)
- **결과**: `{ isValid: true }`

#### 5.2 최소 차이
- **조건**: 1초 차이, 1일 차이 등
- **결과**: `{ isValid: true }`

#### 5.3 100년 기준 경고
- **초과 (> 100년)**: `{ isValid: true, warning: '날짜 범위가 100년을 초과합니다' }`
- **정확히 100년**: `{ isValid: true }` (경고 없음)
- **100년 미만**: `{ isValid: true }` (경고 없음)
- **계산 방법**: `(endDate - startDate) / (1000 * 60 * 60 * 24 * 365) > 100`

#### 5.4 윤년 처리
- 유효한 윤년 날짜 (`2024-02-29`): 정상 처리
- 무효한 윤년 날짜 (`2023-02-29`): 에러 반환

#### 5.5 극단값
- 매우 오래된 날짜 (`0001-01-01`): 정상 처리 (100년 초과 경고 발생 가능)
- 먼 미래 날짜 (`9999-12-31`): 정상 처리 (100년 초과 경고 발생 가능)

#### 5.6 타임존 처리
- 서로 다른 타임존의 날짜도 UTC로 정규화하여 올바르게 비교
- 예: `2024-06-15T23:00:00+09:00`는 `2024-06-15T14:00:00Z`와 동일

### 6. 비기능 요구사항
- **순수 함수**: 부수 효과 없음
- **불변성**: 입력 Date 객체 변경 금지
- **타입 안전성**: TypeScript strict mode 준수

### 7. 테스트 커버리지 요구사항
다음 시나리오를 모두 테스트해야 함:
- 기본 동작 (성공/실패)
- 모든 입력 형식 (Date, ISO 문자열, 혼합)
- 모든 에러 케이스 (null, undefined, 잘못된 형식, 잘못된 타입)
- 경계값 (1초 차이, 1일 차이, 100년, 100년 초과)
- 윤년 처리
- 타임존 처리
- 극단값 (매우 오래된/먼 미래 날짜)

---

## 주요 개선 사항 요약

1. **명확성 향상**:
   - ISO 8601 형식을 구체적으로 명시
   - 모든 에러 메시지를 표로 정리
   - 100년 기준을 정확히 명시 (초과 vs 이하)
   - 비교 정밀도 명시 (밀리초 단위)

2. **완전성 향상**:
   - 타임존 처리 명시
   - 윤년 처리 추가
   - 빈 문자열, 숫자, 객체 입력 케이스 추가
   - 극단값 처리 추가
   - 혼합 입력 타입 명시

3. **일관성 향상**:
   - ValidationResult에 warning 필드 추가
   - 100년 경계값을 명확히 정의
   - null과 undefined 각각의 에러 메시지 명시

4. **테스트 가능성 향상**:
   - 모든 에러 메시지 문구 명시
   - 테스트 커버리지 요구사항 섹션 추가
   - 각 시나리오별 예상 출력 명시
