제공해주신 날짜 범위 검증 함수 명세를 검토하겠습니다.

## 검증 결과

### 명확성
- **평가: 개선 필요**
- **의견:**
  - ISO 8601 문자열의 구체적인 형식이 명시되지 않음 (타임존 포함 여부, 시간 포함 여부 등)
  - "잘못된 날짜 형식"의 정의가 불명확 (예: "2023-13-32", "invalid-date" 등)
  - 100년 이상 차이 시 "경고 메시지"의 구체적인 내용과 반환 형태가 불명확
  - 날짜 비교 시 시간(time) 부분의 처리 방법이 명시되지 않음 (예: 2023-01-01T23:59 vs 2023-01-02T00:01)

### 완전성
- **평가: 개선 필요**
- **의견:**
  - **누락된 엣지 케이스:**
    - 타임존이 다른 날짜 입력 시 처리 방법
    - 유효하지 않은 Date 객체 (Invalid Date) 입력
    - 빈 문자열 입력
    - 숫자(timestamp) 입력 허용 여부
    - 극단적인 날짜 값 (예: 1900년 이전, 2100년 이후)
    - 윤년, 월말 처리
  - **반환값 불일치:** 
    - 100년 이상 차이 시 경고 메시지를 어떻게 반환하는지 불명확 (유효하면서 경고?)
  - 성능 요구사항 미명시

### 테스트 가능성
- **평가: 개선 필요**
- **의견:**
  - 기본적인 테스트 케이스는 유추 가능하나 구체적인 예시가 부족함
  - 에러 메시지의 정확한 문구가 명시되지 않아 테스트 작성 시 모호함
  - 100년 이상 차이 시 경고 메시지의 검증 기준이 불명확
  - 각 에러 상황별 기대되는 `error` 문자열 값이 명시되지 않음

### 일관성
- **평가: 개선 필요**
- **의견:**
  - **충돌하는 요구사항:**
    - 출력 형식은 `{ isValid: true }` 또는 `{ isValid: false, error: string }`으로 정의되었으나, 100년 이상 차이 시 "경고 메시지"를 어떻게 반환할지 불명확 (유효하면서 경고를 어떻게 표현?)
  - "에러 처리" 섹션과 "출력" 섹션의 연결이 명확하지 않음

---

## 개선된 명세

# 기능 명세: 날짜 범위 검증 함수

## 1. 기능 개요
두 날짜 사이의 기간이 유효한지 검증하는 순수 함수를 구현합니다.

## 2. 함수 시그니처
```typescript
function validateDateRange(
  startDate: Date | string,
  endDate: Date | string
): DateRangeValidationResult

interface DateRangeValidationResult {
  isValid: boolean;
  error?: string;
  warning?: string;
}
```

## 3. 입력 명세

### 3.1 허용되는 입력 형식
- **Date 객체**: JavaScript Date 인스턴스
- **ISO 8601 문자열**: 다음 형식을 지원
  - `YYYY-MM-DD` (예: "2023-12-31")
  - `YYYY-MM-DDTHH:mm:ss` (예: "2023-12-31T23:59:59")
  - `YYYY-MM-DDTHH:mm:ssZ` (UTC, 예: "2023-12-31T23:59:59Z")
  - `YYYY-MM-DDTHH:mm:ss±HH:mm` (타임존 포함, 예: "2023-12-31T23:59:59+09:00")

### 3.2 입력 제약사항
- null 또는 undefined는 허용하지 않음
- 빈 문자열은 허용하지 않음
- 유효한 날짜 범위: 1900-01-01 ~ 2099-12-31
- 시간 정보가 없는 경우 00:00:00으로 간주

## 4. 출력 명세

### 4.1 성공 케이스 (유효한 날짜 범위)
```typescript
// 기본 성공
{ isValid: true }

// 100년 이상 차이 시 (유효하지만 경고)
{ 
  isValid: true, 
  warning: "Date range exceeds 100 years. Please verify this is intentional."
}
```

### 4.2 실패 케이스 (무효한 날짜 범위)
```typescript
{ isValid: false, error: "구체적인 에러 메시지" }
```

## 5. 검증 규칙

### 5.1 유효성 기준
- ✅ **유효**: `startDate <= endDate`
- ❌ **무효**: `startDate > endDate`

### 5.2 날짜 비교 방식
- 타임존이 다른 경우: UTC 기준으로 변환 후 비교
- 밀리초 단위까지 정확히 비교
- 시간 정보가 없는 경우: 해당 날짜의 00:00:00.000으로 간주

## 6. 에러 처리

### 6.1 입력 검증 에러
| 조건 | error 메시지 |
|------|--------------|
| startDate가 null/undefined | `"startDate is required"` |
| endDate가 null/undefined | `"endDate is required"` |
| startDate가 빈 문자열 | `"startDate cannot be empty"` |
| endDate가 빈 문자열 | `"endDate cannot be empty"` |
| startDate가 Invalid Date | `"startDate is not a valid date"` |
| endDate가 Invalid Date | `"endDate is not a valid date"` |
| startDate가 지원 범위 밖 | `"startDate must be between 1900-01-01 and 2099-12-31"` |
| endDate가 지원 범위 밖 | `"endDate must be between 1900-01-01 and 2099-12-31"` |
| 지원하지 않는 형식 | `"Date must be a Date object or ISO 8601 string"` |

### 6.2 논리 검증 에러
| 조건 | error 메시지 |
|------|--------------|
| startDate > endDate | `"startDate must be before or equal to endDate"` |

## 7. 엣지 케이스 처리

### 7.1 경계값 테스트
| 케이스 | 입력 예시 | 기대 결과 |
|--------|----------|-----------|
| 같은 날짜 (시간 없음) | "2023-12-31", "2023-12-31" | `{ isValid: true }` |
| 같은 날짜 (시간 포함) | "2023-12-31T10:00:00", "2023-12-31T10:00:00" | `{ isValid: true }` |
| 1밀리초 차이 | "2023-12-31T23:59:59.999", "2024-01-01T00:00:00.000" | `{ isValid: true }` |
| 1일 차이 | "2023-12-31", "2024-01-01" | `{ isValid: true }` |
| 정확히 100년 | "1923-01-01", "2023-01-01" | `{ isValid: true }` |
| 100년 초과 | "1923-01-01", "2023-01-02" | `{ isValid: true, warning: "..." }` |
| 역순 (1밀리초) | "2024-01-01T00:00:00.001", "2024-01-01T00:00:00.000" | `{ isValid: false, error: "..." }` |

### 7.2 타임존 처리
| 케이스 | 입력 예시 | 비교 방법 |
|--------|----------|-----------|
| 타임존 포함 | "2023-12-31T15:00:00+09:00", "2024-01-01T00:00:00Z" | UTC로 변환 후 비교 (동일 시각) |
| 타임존 혼재 | "2023-12-31", "2024-01-01T00:00:00+09:00" | UTC 기준 변환 후 비교 |

### 7.3 특수 날짜
| 케이스 | 처리 방법 |
|--------|-----------|
| 윤년 (2/29) | 정상 처리 (유효한 날짜로 인정) |
| 윤년 아님 (2/29) | Invalid Date 에러 처리 |
| 월말 (1/31, 12/31) | 정상 처리 |
| DST 전환 시각 | UTC 변환 후 비교 (시스템 타임존 정보 활용) |

## 8. 비기능 요구사항
- **성능**: 단일 검증 실행 시간 < 10ms
- **부작용 없음**: 입력 Date 객체를 변경하지 않음 (순수 함수)
- **의존성**: 외부 라이브러리 사용하지 않음 (Native JavaScript API만 사용)

## 9. 테스트 케이스 예시

### 9.1 정상 케이스
```javascript
// TC-001: 같은 날짜
validateDateRange("2023-12-31", "2023-12-31")
// Expected: { isValid: true }

// TC-002: 일반적인 기간
validateDateRange("2023-01-01", "2023-12-31")
// Expected: { isValid: true }

// TC-003: 100년 초과 (경고)
validateDateRange("1920-01-01", "2023-12-31")
// Expected: { isValid: true, warning: "Date range exceeds 100 years..." }
```

### 9.2 에러 케이스
```javascript
// TC-101: null 입력
validateDateRange(null, "2023-12-31")
// Expected: { isValid: false, error: "startDate is required" }

// TC-102: Invalid Date
validateDateRange("invalid", "2023-12-31")
// Expected: { isValid: false, error: "startDate is not a valid date" }

// TC-103: 역순 날짜
validateDateRange("2024-01-01", "2023-12-31")
// Expected: { isValid: false, error: "startDate must be before or equal to endDate" }
```

## 10. 구현 제약사항
- TypeScript로 구현 (타입 안정성)
- 입력 검증을 출력 생성보다 먼저 수행
- 에러 메시지는 정확히 명세된 문자열을 사용 (테스트 일관성)

---

## 주요 개선 사항 요약

1. **명확성 향상**
   - ISO 8601 형식 구체화
   - 시간/타임존 처리 방법 명시
   - 에러 메시지 문구 표준화

2. **완전성 보완**
   - 타임존, Invalid Date, 빈 문자열 등 누락된 케이스 추가
   - 날짜 범위 제약 명시
   - 비기능 요구사항 추가

3. **테스트 가능성 개선**
   - 구체적인 테스트 케이스 예시 제공
   - 에러 메시지 문구 명시
   - 표 형식으로 입출력 매핑

4. **일관성 확보**
   - 경고 메시지를 별도 `warning` 필드로 분리
   - 반환 타입 인터페이스 명확화
   - 모든 에러 케이스에 대한 일관된 처리 방식 정의
